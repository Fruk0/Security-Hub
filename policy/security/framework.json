{
  "version": "1.0.1",
  "framework": "Security Risk Quick Scoring",
  "description": "Formulario de 8 ítems diseñado para clasificar el nivel de riesgo según criterios de seguridad reconocidos.",
  "questions": [
    { "id": 1, "text": "¿El cambio expone un endpoint o ruta accesible desde internet?", "dimension": "Likelihood", "weight": 3, "invert_logic": false, "notes": "Superficie de ataque / exposición externa." },
    { "id": 2, "text": "¿Requiere o modifica autenticación, sesiones o roles/privilegios?", "dimension": "Impact",     "weight": 3, "invert_logic": false, "notes": "Control de acceso, session handling, BOLA/BOPLA." },
    { "id": 3, "text": "¿Procesa o transmite datos sensibles/financieros (PII, credenciales, cuentas)?", "dimension": "Impact", "weight": 3, "invert_logic": false, "notes": "Confidencialidad, cumplimiento (PCI/GDPR)." },
    { "id": 4, "text": "¿Permite operaciones críticas (transferencias, altas/bajas, préstamos, límites)?", "dimension": "Impact", "weight": 3, "invert_logic": false, "notes": "Integridad y riesgo de negocio." },
    { "id": 5, "text": "¿Recibe input complejo (archivos, URLs, JSON libre, input no validado)?", "dimension": "Likelihood", "weight": 2, "invert_logic": false, "notes": "Injection / validación de entradas." },
    { "id": 6, "text": "¿Integra con APIs/SDKs externos o dependencias nuevas?", "dimension": "Likelihood", "weight": 2, "invert_logic": false, "notes": "Supply chain / riesgo de integración." },
    { "id": 7, "text": "¿Requiere secretos/llaves o usa cripto nueva (JWT, hashing, firmas)?", "dimension": "Impact", "weight": 2, "invert_logic": false, "notes": "Configuración sensible / criptografía." },
    { "id": 8, "text": "¿Cuenta con rate-limit, logs y alertas de seguridad para esta funcionalidad?", "dimension": "Likelihood", "weight": 2, "invert_logic": true,  "notes": "Si la respuesta es 'No' o 'No sé', suma puntaje (penaliza falta de detección/anti-abuso)." }
  ],
  "responses": ["Sí", "No", "No sé"],
  "scoring": {
    "rules": [
      { "id": "NOSE_COUNTS_AS_YES", "condition": "Respuesta = 'No sé'", "effect": "Cuenta como 'Sí' para puntaje (salvo preguntas con invert_logic=true)." },
      { "id": "EXPOSED_AND_SENSITIVE_MIN_HIGH", "condition": "(Q1 = Sí|No sé) AND (Q2 = Sí|No sé OR Q3 = Sí|No sé OR Q4 = Sí|No sé)", "effect": "Severidad mínima = 'Alto' (si el cálculo base da menos, elevar a 'Alto')." }
    ],
    "bands": [
      { "min": 0, "max": 5, "label": "Bajo" },
      { "min": 6, "max": 9, "label": "Medio" },
      { "min": 10, "max": 14, "label": "Alto" },
      { "min": 15, "max": 20, "label": "Crítico" }
    ],
    "ranges": { "Likelihood_max": 9, "Impact_max": 11, "Total_max": 20 },
    "aggregation": "FinalScore = Sum(Likelihood) + Sum(Impact); FinalBand = bands(FinalScore) con reglas aplicadas."
  },
  "ui": {
    "one_page": true,
    "answer_type": "radio",
    "require_comment_on": ["No sé"],
    "defaults": { "unanswered": "No" }
  },
  "storage": {
    "persist": ["answers", "final_score", "final_band", "timestamp", "ticket_id", "comments"],
    "target": "Jira u otra VM tool"
  }
}
